{"name":"Vba gen pdf","tagline":"Création d'un PDF à partir d'un onglet excel","body":"# VBA_Gen_PDF\r\nMacro VBA pour générer un pdf à partir d'un onglet\r\n\r\n## Instruction\r\n- Soit créer un module dans votre projet vba et y copier/coller le code ci-dessous\r\n- Soit télécharger le module (fichier *.bas) et l'inserer dans votre projet vba\r\n\r\n##Code\r\n```bash\r\nSub gen_pdf(nom_feuille As String, nom_pdf As String, Optional chemin As String = \"\", Optional chemin_relatif As Boolean = False)\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n'!!!TITRE : Génère un pdf à partir d'un onglet                                            \t\t\t!!!\r\n'!!!DATE : 24.04.2015                              \t\t\t\t\t\t\t\t\t\t\t\t\t!!!\r\n'!!!                                                                          \t\t\t\t\t\t!!!\r\n'!!!DESCRIPTION :Création d'un PDF à partir d'un onglet excel\t\t\t\t\t\t\t\t\t\t!!!\r\n'!!!                                                                               \t\t\t\t\t!!!\r\n'!!!REGLES :\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!!!\r\n'!!!- utilise le nom de l'onglet et génère un pdf de cet onglet en appelé le nom_pdf   \t\t\t\t!!!\r\n'!!!- le chemin par défaut pour l'enregistrement du pdf est l'emplacement du fichier excel\t\t\t!!!\r\n'!!!- si un chemin est spécifié, par défaut il est en absolu, c'est à dire, le chemin complet, si   !!!\r\n'!!!vous voulez utiliser le chemin en relatif, il faut forcé l'argument chemin_realtif à true       !!!\r\n'!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\r\n    'déclaration des variables\r\n    Dim feuille_actuelle As String\r\n   \r\n    'génère le chemin\r\n    If chemin = \"\" Then\r\n        chemin_pdf = ThisWorkbook.Path & Application.PathSeparator & nom_pdf & \".pdf\"\r\n    Else\r\n        If chemin_relatif = False Then\r\n            chemin_pdf = chemin & Application.PathSeparator & nom_pdf & \".pdf\"\r\n        Else\r\n            chemin_pdf = ThisWorkbook.Path & Application.PathSeparator & chemin & Application.PathSeparator & nom_pdf & \".pdf\"\r\n        End If\r\n    End If\r\n   \r\n    'sélection l'onglet, génère le pdf, et reviens à l'onglet de départ\r\n    Application.ScreenUpdating = False\r\n    feuille_actuelle = ActiveSheet.Name\r\n    Sheets(nom_feuille).Select\r\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=chemin_pdf _\r\n        , Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas _\r\n        :=False, OpenAfterPublish:=True\r\n    Sheets(feuille_actuelle).Select\r\n    Application.ScreenUpdating = True\r\nEnd Sub\r\n```\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}